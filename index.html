<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <head>
    
<!--  放入這三行開始 -->
<link rel="icon" type="image/png" href="./icon.png">
<link rel="apple-touch-icon" href="./icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="./icon.png">
<!--  放入這三行結束 -->
    
</head>

  <!-- 先把 style.css 註解掉，避免遮罩擋點擊 -->
  <!-- <link rel="stylesheet" href="style.css"> -->

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Youfiel 飾品搭配小幫手</title>

  <!-- 字體：乾淨質感 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Noto+Sans+TC:wght@400;600&display=swap" rel="stylesheet">

  <!-- PapaParse for CSV -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

  <style>
    :root{
      --bg: #fbf8f3;
      --card: #ffffff;
      --ink: #2c2c2c;
      --muted: #8c8c8c;
      --line: #e9e2d8;
      --accent: #b79b7c;
      --accent-soft: #fff3e3;
      --radius: 16px;
      --shadow: 0 6px 22px rgba(30, 20, 10, 0.06);
    }

    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:"Inter","Noto Sans TC",system-ui,sans-serif;
      background: radial-gradient(1200px 600px at 10% -10%, #fffdf9 0%, transparent 60%),
                  radial-gradient(900px 500px at 110% 0%, #fff7ed 0%, transparent 55%),
                  var(--bg);
      color:var(--ink);
    }

    .wrap{
      max-width:920px;
      margin:0 auto;
      padding:22px 18px 60px;
      position:relative;
      z-index:1;
    }

    /* ✅ banner 不會擋點擊 */
    .banner{
      width:100%;
      height:auto;
      display:block;
      border-radius:16px;
      margin-bottom:16px;
      position:relative;
      z-index:0;
      pointer-events:none;
    }

    header{
      display:flex;
      align-items:center;
      gap:12px;
      margin-bottom:14px;
    }

    .title-area p{
      margin:0;
      color:var(--muted);
      font-size:13px;
      line-height:1.6;
    }

    .section{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      padding:16px;
      box-shadow:var(--shadow);
      margin-top:12px;
      position:relative;
      z-index:1;
    }

    .section h2{
      font-size:14px;
      margin:0 0 10px 0;
      color:var(--muted);
      font-weight:600;
      letter-spacing:.5px;
      text-transform:uppercase;
    }

    .scenes{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:10px;
    }
    @media (max-width:640px){
      .scenes{grid-template-columns:repeat(2,1fr);}
    }

    .scene-btn{
      padding:14px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:#fff;
      cursor:pointer;
      text-align:left;
      transition:.2s;
      display:flex;
      flex-direction:column;
      gap:4px;
      min-height:72px;
      position:relative;
      z-index:2;
    }
    .scene-btn .en{font-size:12px;color:var(--muted);}
    .scene-btn .zh{font-size:15px;font-weight:600;}
    .scene-btn:hover{
      border-color:var(--accent);
      background:#fffaf2;
      transform:translateY(-1px);
    }
    .scene-btn.active{
      border-color:var(--accent);
      background:var(--accent-soft);
      box-shadow:0 0 0 2px rgba(183,155,124,.12) inset;
    }

    .metals{display:flex;gap:10px;}
    .metal-btn{
      flex:1;
      padding:12px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:#fff;
      cursor:pointer;
      font-weight:600;
      transition:.2s;
      position:relative;
      z-index:2;
    }
    .metal-btn:hover{
      border-color:var(--accent);
      background:#fffaf2;
    }
    .metal-btn.active{
      border-color:var(--accent);
      background:var(--accent-soft);
    }

    .gen{
      width:100%;
      padding:14px 12px;
      border:none;
      border-radius:14px;
      background:var(--accent);
      color:#fff;
      font-size:16px;
      font-weight:600;
      cursor:pointer;
      transition:.2s;
      position:relative;
      z-index:2;
    }
    .gen:hover{filter:brightness(.97);transform:translateY(-1px);}
    .gen:disabled{opacity:.6;cursor:not-allowed;transform:none;}

    .result-card{
      background:#fff;
      border:1px dashed var(--line);
      border-radius:14px;
      padding:14px;
      line-height:1.9;
      font-size:15px;
    }

    .result-title{
      font-weight:700;
      margin-bottom:6px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .tag{
      font-size:12px;
      color:var(--muted);
      background:#f7f3ed;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid var(--line);
      white-space:nowrap;
    }

    .item{display:flex;gap:8px;margin-top:6px;}
    .item .label{
      width:78px;
      color:var(--muted);
      font-size:14px;
      flex:0 0 auto;
    }

    .item-img{
      width:80px;height:80px;object-fit:cover;
      border-radius:12px;margin-bottom:4px;
      box-shadow:var(--shadow);
      display:block;
    }

    .summary{
      margin-top:8px;padding-top:8px;
      border-top:1px solid var(--line);
      color:#5a5146;font-size:14px;
    }

    .hint{color:var(--muted);font-size:14px;}
  </style>
</head>

<body>
  <div class="wrap">
    <img class="banner" src="banner.jpg" alt="Youfiel Match">

    <header>
      <div class="title-area">
        <p>Choose your moment and your tone in gold or silver.
Find a delicate, effortless set that matches your quiet glow.</p>
      </div>
    </header>

    <section class="section">
      <h2>Step 1 · 選擇場合</h2>
      <div class="scenes" id="scenes"></div>
    </section>

    <section class="section">
      <h2>Step 2 · 選擇色系</h2>
      <div class="metals" id="metals">
        <button class="metal-btn" data-metal="gold">金色系搭配</button>
        <button class="metal-btn" data-metal="silver">銀色系搭配</button>
      </div>
    </section>

    <section class="section">
      <button class="gen" id="genBtn">生成今日搭配</button>
      <div style="height:12px"></div>
      <div class="result-card" id="result">
        <div class="hint">請先完成 Step 1 + Step 2</div>
      </div>
    </section>
  </div>

<script>
  const SHEET_CSV_URL =
    "https://docs.google.com/spreadsheets/d/e/2PACX-1vTsStzXXf_IXr0A3rPu8Lg1j6NJZQUVVkPle_6f-Njmj69AG2A9rT-JFYIGMkfgHPKMnHS8v6Zk02PV/pub?gid=0&single=true&output=csv&t=" + Date.now();

  const SCENES = [
    { key:"wedding", zh:"婚禮 / 正式宴會", en:"Wedding / Ceremony" },
    { key:"date",    zh:"約會 / 浪漫外出", en:"Date / Romance" },
    { key:"meeting", zh:"開會 / 面試 / 工作", en:"Meeting / Work" },
    { key:"travel",  zh:"旅遊拍照 / 週末出門", en:"Travel / Weekend" },
    { key:"daily",   zh:"日常上班 / 百搭隨手", en:"Daily / Easy match" },
  ];

  let currentSceneKey = null;
  let currentMetalKey = null;

  let looksData = [];
  let looksLoaded = false;

  const scenesEl = document.getElementById("scenes");
  const resultEl = document.getElementById("result");
  const genBtn = document.getElementById("genBtn");

  function loadLooks(){
  genBtn.disabled = true;
  resultEl.innerHTML = `<div class="hint">資料載入中…</div>`;

  Papa.parse(SHEET_CSV_URL, {
    download: true,
    header: true,
    complete: (results) => {
      looksData = results.data
        .map(r => ({
          ...r,
          scene: (r.scene || r["\ufeffscene"] || "").trim().toLowerCase(),
          metal: (r.metal || "").trim().toLowerCase(),
        }))
        .filter(r => r.scene && r.metal);

      looksLoaded = true;
      genBtn.disabled = false;
      resultEl.innerHTML = `<div class="hint">請先完成 Step 1 + Step 2</div>`;
    },
    error: (err) => {
      looksLoaded = false;
      genBtn.disabled = false;
      resultEl.innerHTML = `
        <div class="hint">
          CSV 讀取失敗：${err?.message || err}<br>
          （若你是用 file:// 打開，請改用 GitHub Pages 或 Live Server）
        </div>`;
    }
  });
}


  function pickLook(sceneKey, metalKey){
    const s = (sceneKey || "").trim().toLowerCase();
    const m = (metalKey || "").trim().toLowerCase();
    const pool = looksData.filter(r => r.scene === s && r.metal === m);
    return pool.length ? pool[Math.floor(Math.random() * pool.length)] : null;
  }

  // 場合按鈕
  SCENES.forEach(s=>{
    const btn = document.createElement("button");
    btn.type = "button";
    btn.className = "scene-btn";
    btn.innerHTML = `<div class="en">${s.en}</div><div class="zh">${s.zh}</div>`;
    btn.addEventListener("click", ()=>{
      currentSceneKey = s.key;
      document.querySelectorAll(".scene-btn").forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      resultEl.innerHTML = `<div class="hint">已選擇場合：${s.zh}</div>`;
    });
    scenesEl.appendChild(btn);
  });

  // 金銀按鈕
  document.querySelectorAll(".metal-btn").forEach(btn=>{
    btn.type = "button";
    btn.addEventListener("click", ()=>{
      currentMetalKey = btn.dataset.metal;
      document.querySelectorAll(".metal-btn").forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
    });
  });

  // 生成搭配
  genBtn.addEventListener("click", ()=>{
    if(!looksLoaded){
      resultEl.innerHTML = `<div class="hint">資料還在載入或讀取失敗，稍後再試</div>`;
      return;
    }
    if(!currentSceneKey || !currentMetalKey){
      resultEl.innerHTML = `<div class="hint">請先完成 Step 1 + Step 2</div>`;
      return;
    }

    const sceneObj = SCENES.find(s=>s.key===currentSceneKey);
    const metalZh = currentMetalKey==="gold" ? "金色系" : "銀色系";
    const pick = pickLook(currentSceneKey, currentMetalKey);

    if(!pick){
      resultEl.innerHTML = `<div class="hint">這個場合目前沒有對應 ${metalZh} 搭配</div>`;
      return;
    }

    resultEl.innerHTML = `
      <div class="result-title">
        <div>${sceneObj.zh}｜${metalZh}搭配</div>
        <div class="tag">Youfiel picks</div>
      </div>

      <div class="item">
        <div class="label">項鍊</div>
        <div>
          <img class="item-img" src="${pick.necklace_img || ""}" alt="">
          <div>${pick.necklace || "-"}</div>
        </div>
      </div>

      <div class="item">
        <div class="label">耳環</div>
        <div>
          <img class="item-img" src="${pick.earrings_img || ""}" alt="">
          <div>${pick.earrings || "-"}</div>
        </div>
      </div>

      <div class="item">
        <div class="label">手鍊/手環</div>
        <div>
          <img class="item-img" src="${pick.bracelet_img || ""}" alt="">
          <div>${pick.bracelet || "-"}</div>
        </div>
      </div>

      <div class="item">
        <div class="label">戒指</div>
        <div>
          <img class="item-img" src="${pick.ring_img || ""}" alt="">
          <div>${pick.ring || "-"}</div>
        </div>
      </div>

      ${pick.summary ? `<div class="summary">${pick.summary}</div>` : ""}
    `;
  });

  loadLooks();
</script>
</body>
</html>
